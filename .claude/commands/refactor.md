Refactor this code for readability and maintainability. Keep functionality identical.